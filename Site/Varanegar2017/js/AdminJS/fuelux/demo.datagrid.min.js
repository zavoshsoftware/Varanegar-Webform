!function(n){n(function(){var t=function(n){this._formatter=n.formatter;this._columns=n.columns;this._delay=n.delay};t.prototype={columns:function(){return this._columns},data:function(t,i){var u="js/data/datagrid.json",r=this;setTimeout(function(){var f=n.extend(!0,[],r._data);n.ajax(u,{dataType:"json",async:!1,type:"GET"}).done(function(n){var u;f=n.geonames;t.search&&(f=_.filter(f,function(n){var i=!1;return _.each(n,function(n){(_.isString(n)||_.isFinite(n))&&n.toString().toLowerCase().indexOf(t.search.toLowerCase())!==-1&&(i=!0)}),i}));t.filter&&(f=_.filter(f,function(n){switch(t.filter.value){case"lt5m":if(n.population<5e6)return!0;break;case"gte5m":if(n.population>=5e6)return!0;break;default:return!0}}));u=f.length;t.sortProperty&&(f=_.sortBy(f,t.sortProperty),t.sortDirection==="desc"&&f.reverse());var e=t.pageIndex*t.pageSize,o=e+t.pageSize,s=o>u?u:o,h=Math.ceil(u/t.pageSize),c=t.pageIndex+1,l=e+1;f=f.slice(e,o);r._formatter&&r._formatter(f);i({data:f,start:l,end:s,count:u,pages:h,page:c})}).fail(function(){})},r._delay)}};n("#MyStretchGrid").each(function(){n(this).datagrid({dataSource:new t({columns:[{property:"toponymName",label:"Name",sortable:!0},{property:"countrycode",label:"Country",sortable:!0},{property:"population",label:"Population",sortable:!0},{property:"fcodeName",label:"Type",sortable:!0},{property:"geonameId",label:"Edit",sortable:!0}],formatter:function(t){n.each(t,function(n,t){t.geonameId='<a href="modal.html?geonameid='+t.geonameId+'" data-toggle="ajaxModal"><i class="fa fa-pencil"><\/i><\/a>'})}})})})})}(window.jQuery);